alert tcp any any -> any 102 (msg:"S7COMM: Connection setup"; content:"|03 00|"; depth:2; offset:0; content:"|32 01|"; within:10; distance:4; sid:100001; rev:5;)
alert tcp any any -> any 102 (msg:"S7COMM: Job Request"; content:"|03 00|"; depth:2; offset:0; content:"|32 01|"; within:10; distance:4; content:"|01|"; within:15; distance:7; sid:100008; rev:3;)
alert tcp any any -> any 102 (msg:"S7COMM: User Data"; content:"|03 00|"; depth:2; offset:0; content:"|32 02|"; within:10; distance:4; sid:100009; rev:3;)
alert tcp any 102 -> any any (msg:"S7COMM: PLC Response"; content:"|03 00|"; depth:2; offset:0; sid:100010; rev:3;)
alert tcp any any -> any 102 (msg:"S7COMM: Setup Communication"; content:"|03 00 00 16|"; depth:4; offset:0; content:"|11|"; within:10; distance:5; sid:100011; rev:2;)
alert tcp any any -> any 102 (msg:"S7COMM: Parameter setup"; content:"|03 00|"; depth:2; offset:0; content:"|32 07|"; within:10; distance:4; sid:100012; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM: Download block"; content:"|03 00|"; depth:2; offset:0; content:"|32 1a|"; within:10; distance:4; sid:100013; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM: Upload block"; content:"|03 00|"; depth:2; offset:0; content:"|32 1d|"; within:10; distance:4; sid:100014; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM: PLC control"; content:"|03 00|"; depth:2; offset:0; content:"|32 28|"; within:10; distance:4; sid:100015; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM: Security request"; content:"|03 00|"; depth:2; offset:0; content:"|32 29|"; within:10; distance:4; sid:100016; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM: Very malformed packet"; dsize:<4; sid:100005; rev:5;)
alert tcp any any -> any 102 (msg:"S7COMM: Suspected Scan"; threshold:type both, track by_src, count 10, seconds 5; sid:100004; rev:2;)
alert tcp any any -> any 102 (msg:"S7COMM: Very large packet"; dsize:>1024; sid:100020; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM+: Detect"; content:"|72|"; depth:1; offset:0; within:5; sid:100030; rev:1;)
alert tcp any any -> any 102 (msg:"S7COMM: Invalid format"; content:"|03 00|"; depth:2; offset:0; byte_test:2,>,1024,2,relative; sid:100031; rev:1;)